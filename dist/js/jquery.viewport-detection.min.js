!function(t,e,n,i){"use strict";function o(e,n,i,o){this.cache=i,this.$settings=t.extend({},l,n),this.$container=t(this.$settings.target,e),this.$globalContainer=t(o),this._defaults=l,this._name=s,this.init()}var s="viewportDetection",l={debug:!1,visible:function(){},invisible:function(){},debounce:{wait:0,immediate:!0},offset:{top:0,right:0,bottom:0,left:0},infinite:!0,target:"> *"};t.extend(o.prototype,{init:function(){this.getContainer(),this.setElements(),this.elementInContainer(),this.scrollEvent().on()},debounce:function(t,e,n){var i;return function(){var o=this,s=arguments,l=function(){i=null,n||t.apply(o,s)},c=n&&!i;clearTimeout(i),i=setTimeout(l,e),c&&t.apply(o,s)}},getContainer:function(){var t=this.$globalContainer,e=this.$settings.offset;return{top:t.scrollTop()+e.top,right:t.scrollLeft()+t.width()+e.right,bottom:t.scrollTop()+t.height()+e.bottom,left:t.scrollLeft()+e.left}},setElements:function(){var e=this;t.each(this.$container,function(){var n=t(this);e.cache.elements.push({infinite:!0,visible:!1,node:n,position:{top:n.offset().top,right:n.offset().left+n.width(),bottom:n.offset().top+n.height(),left:n.offset().left}})})},elementInContainer:function(){var e=this,n=this.getContainer();t.each(e.cache.elements,function(t){var i=e.cache.elements[t];i.position.left<=n.right&&i.position.right>=n.left&&i.position.top<=n.bottom&&i.position.bottom>=n.top?1!=i.visible&&(i.visible=!0,e.handleCallback(e.$settings.visible,t),1!=e.$settings.infinite&&i.infinite&&e.cache.elementCount++):1==e.$settings.infinite&&1==i.visible&&(i.visible=!1,e.handleCallback(e.$settings.invisible,t))}),1!=e.$settings.infinite&&e.cache.elementCount==e.cache.elements.length&&e.scrollEvent().off()},handleCallback:function(t,e){var n=this;"function"==typeof t?t(n.cache.elements[e].node):this.$settings.debug&&console.error(this._name+": '"+t+"' is not a function.")},scrollEvent:function(){var t,e=this,n=this.$settings;return t=e.debounce(function(){e.elementInContainer()},n.debounce.wait,n.debounce.immediate),{on:function(){e.$globalContainer.on("scroll",function(){t()})},off:function(){e.$globalContainer.off("scroll",this.on())}}}}),t.fn[s]=function(n){return this.each(function(){if(!t.data(this,"plugin_"+s)){var i={elements:[],elementCount:0};t.data(this,"plugin_"+s,new o(this,n,i,e))}})}}(jQuery,window,document);